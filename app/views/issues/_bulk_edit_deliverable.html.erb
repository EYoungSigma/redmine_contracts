<% if project.module_enabled?(:contracts) %>
  <p>
    <%= label_tag(:deliverable_id, l(:field_deliverable)) %>
    <% options = project.contracts.inject([]) {|data, contract|
         data << [contract.name, contract.deliverables.collect {|d| [d.title, d.id]} ]
       } %>

    <%= select_tag('deliverable_id',
                   content_tag('option', l(:label_no_change_option), :value => '') +
                   content_tag('option', l(:label_none), :value => 'none') +
                   grouped_options_for_select(options)) %>
  </p>
<% end %>

